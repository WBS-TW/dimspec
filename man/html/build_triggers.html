<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Build pairs of INSERT/UPDATE triggers to resolve foreign key...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for build_triggers"><tr><td>build_triggers</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Build pairs of INSERT/UPDATE triggers to resolve foreign key relationships</h2>

<h3>Description</h3>

<p>When building schema by script, it is often handy to enforce certain
behaviors on database transactions involving foreign keys, especially in
SQLite. Given a properly structured list object describing the mappings
between tables in a schema (e.g. one deriving from [er_map]), this function
will parse those for foreign key relationships.
</p>


<h3>Usage</h3>

<pre>
build_triggers(er_map(db_conn = con))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>db_map</code></td>
<td>
<p>LIST object containing descriptions of table mapping in an
opinionated manner, generally generated by [er_map]. The expectation is a
list of tables, with references in SQL form enumerated in a child element
with a name matching 'references_in'</p>
</td></tr>
<tr valign="top"><td><code>references_in</code></td>
<td>
<p>CHR scalar naming the child element containing SQL
references statements of the form &quot;fk_column REFERENCES table(pk_column)&quot;
(default: &quot;references&quot; is provided by [er_map])</p>
</td></tr>
<tr valign="top"><td><code>create_insert_trigger</code></td>
<td>
<p>LGL scalar indicating whether to build an insert
trigger for each table (default: TRUE).</p>
</td></tr>
<tr valign="top"><td><code>create_update_trigger</code></td>
<td>
<p>LGL scalar indicating whether to build an update
trigger for each table (default: FALSE).</p>
</td></tr>
<tr valign="top"><td><code>save_to_file</code></td>
<td>
<p>CHR scalar of a file in which to write the output, if any
(default: NULL will return the resulting object to the R session)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Primarily, this requires a list object referring to tables that contains in
each element a child element with the name provided in 'references_in'. The
pre-pass parsing function [get_fkpk_relationships] is used to pull references
from the full map is used.
</p>


<h3>Value</h3>

<p>LIST object containing one element for each table in 'db_map'
containing foreign key references, with one child
</p>


<h3>Note</h3>

<p>Tables in 'db_map' that do not contain foreign key relationships will
be dropped from the output list.
</p>
<p>This is largely a convenience function to programmatically apply
[make_sql_triggers] to an entire schema. To skip tables with defined
foreign key relationships for which triggers are undesirable, remove those
tables from 'db_map' prior to calling this function.
</p>


</body></html>
